“Атлас жизни” (ядро проекта)
Рабочие правила

Не переписываем всё — двигаемся итерациями, меняем только нужные модули.

Не даём «кусочки» — поставки целыми файлами или архивом версий.

Версионирование: Atlas_of_life_vX.Y.Z, SemVer MAJOR.MINOR.PATCH + CHANGELOG. Архив: Atlas_of_life_vX.Y.Z.zip.

Цели MVP, сценарии, критерии — см. базовый PRD (в проекте, v0.1).

1. Видение (кратко)

Личная карта-вселенная: Домены → Проекты → Задачи/Идеи. Главная ценность — быстро понять «что важно сегодня» и не терять идеи/обещания. Local-first: офлайн, приватность, экспорт/импорт. (См. PRD: миссия/УТП.)

2. Что уже есть в коде (опорные факты)

Карта (Canvas 2D): домены-ауры, проекты-орбиты, задачи-планеты; подсветка связей по hover; лимит рёбер (слайдер «Связи»).

Инспектор справа: быстрые действия, смена статуса, добавление задач/проектов.

Экран «Сегодня»: список задач status='today', отметка «Готово».

Инбокс + парсер: #тег @проект !когда ~30м p1..p4 (RU-даты «сегодня/завтра/пн», «через 30м/1ч»).

Сигналы «старения» (кольцо цвета по давности), цвета статусов (today/doing/done/backlog).

Фильтры/домены/теги, экспорт/импорт JSON, localStorage.

3. Основная механика (то, на что опираемся)

Визуал: ауры доменов → орбиты проектов → планеты задач; bezier-связи по общим тегам. Пользователь может фильтровать по домену/тегу/статусу и видеть подсвеченный подграф.

Исполнение: вкладка «Сегодня», мягкий WIP-лимит (предупреждение при перегрузе, цель — удерживать фокус).

Захват: одно поле ввода с парсером; добавление ≤3 сек; всё должно появляться и на карте, и в «Сегодня».

4. Визуальные паттерны (делаем так)

M-01 Domain Aura: Радиальный градиент + пунктирная граница.

M-02 Project Orbit: Тонкое кольцо орбиты + подпись сверху.

M-03 Task Planet: размер = важность (приоритет/impact); у today — тонкое жёлтое кольцо.

M-04 Aging Ring: кольцо «старения» (зелёный→янтарь→красный).

M-05 Link Bezier: лёгкие bezier-рёбра; глобальный cap + локальная подсветка при hover.

M-06 Hover Highlight: утолщаем и подсвечиваем только рёбра к наведённому узлу.

M-07 Status Palette: backlog=серый, today=янтарь, doing=синий, done=серо-зелёный.

M-08 Glow Soft: легкий shadowBlur по тумблеру (на слабых — выкл.).

(Post-MVP) M-09 Мини-карта; M-10 Ручные связи; M-11 «Порталы» между доменами.

5. UX-правила взаимодействия

Пан/зум: колесо — зум; Alt+ЛКМ — панорама; кнопки в шапке: Центр/+/−/Сброс (есть/часть внедрена).

Hover → тултип + подсветка рёбер; Click → инспектор объекта.

Фильтры: домены (левая колонка), теги, статус-чипы («Все/Сегодня/В работе/Готово»).

Инбокс: подсветка распознанных маркеров под полем (#/@/!/~/p).

6. Модель данных (MVP с запасом)

Domain{id,title,color,createdAt,updatedAt}
Project{id,domainId,title,tags[],priority?,createdAt,updatedAt}
Task{id,projectId,title,tags[],status('backlog'|'today'|'doing'|'done'),estimateMin?,priority?,impact?,createdAt,updatedAt}
(позже) Link{id,fromId,toId,type('related'|'depends'),weight?}

7. Парсер быстрого ввода (RU) — синтаксис и края

Синтаксис: #тег @проект !когда ~30м p1..p4. Пробелы/регистры — гибко.

Время: «сегодня», «завтра 10:00», дни недели («пн 9:30»), «через 30м/1ч».

Edge cases: несколько #тегов; кириллица/дефис в тегах; @проект по регистронезависимому совпадению; ~ до 180м — иначе предупреждение; p1..p4 нормализуем в 1..4.

При отсутствии @ — берём проект активного домена или первый в списке.

8. Статусы, «Сегодня», WIP, «старение»

backlog/plan, today, doing, done. Цель — управлять вниманием.

WIP-лимит (по умолчанию 3–5) — мягкое предупреждение в футере.

«Старение»: 0–2 дня зелёный; 3–6 — салат; 7–14 — янтарь; >14 — красный (застой).

9. Производительность и degrade

Цель: 200–300 задач / ≤300 рёбер без лагов, 40–60 FPS.

Техники: слои (связи→ауры→точки), cap рёбер + подсветка только нужных, отключаемый glow, перерисовка по событию.

10. Хранение/приватность и резервные копии

MVP: localStorage + кнопки Экспорт/Импорт JSON в шапке. (Далее — IndexedDB, когда вырастет объём.)

Хранить минимум 3 последних бэкапа (имя atlas_export_YYYY-MM-DD.json).

Без сетевых запросов/телеметрии по умолчанию. (Политика — локально.)

11. UI-микротексты (тон и примеры)

Пусто в «Сегодня»: «На сегодня задач нет. Отметьте задачи как „Сегодня“ или добавьте через инбокс».

Импорт: «Импорт выполнен / Неверная структура JSON — нужны domains/projects/tasks».

WIP: «Внимание: лимит ‘В работе’ превышен».

12. Клавиши (предложение)

N — фокус в инбокс; + / − — зум; Alt+ЛКМ — пан; 1/2/3/4 — фильтр статуса; Esc — снять выделение; C/R — центр/сброс.

13. Выжимка из исследования (что берём и зачем)

Heptabase/Obsidian Canvas/Miro — плавный зум/пан, мини-карта, подсветка связей → ориентир для карты.

Things/Sunsama/Todoist — быстрый захват, отдельный «Сегодня», жёсткий фокус дня.

Obsidian/Logseq — граф по тегам, управляемая плотность рёбер.

Избегаем: тяжёлых бандлов, скрытой «магии» автосортировки, зависимости от облака.

Применение: наш гибрид «ауры→орбиты→планеты» + фильтры, cap рёбер, локальность.

14. Дорожная карта (ближайшее)

Спринт 1 (текущее): тост-уведомления, кнопки навигации карты, фильтры статуса, валидация импорта, цвета/легенда.

Спринт 2: drag&drop узлов с сохранением позиций, мини-карта, ручные связи, мини-таймер «Сегодня».

Спринт 3: IndexedDB, подсказки тегов/проектов, пресеты видов карты.

15. Промпты для GPT в VS Code (чтобы не объяснять заново)

«Прочитай MEMORY.md. Доработай js/view_map.js: подсветка рёбер только у видимых узлов и ограничение рёбер по state.maxEdges, сохрани FPS.»

«Сверь обработчик импорта в js/storage.js с моделью данных из MEMORY.md; добавь человекочитаемые ошибки, не ломай существующий формат.»

«Добавь горячие клавиши (см. раздел 12) и статус-фильтры в js/app.js; убедись, что карта и „Сегодня“ синхронны.»

«Сделай drag&drop позиций узлов (проекты/задачи) и сохрани их в state/storage; добавь кнопку „Ауто-раскладка“.»

# Changelog

История версий (релизы) + дорожная карта (планы/идеи). Формат релизов: Atlas_of_life_vX.Y.Z. В UI версия берётся по первой секции `## Atlas_of_life_vX.Y.Z` сверху.

---

## Atlas_of_life_v0.2.8 - 2025-09-09

### Улучшения создания задач
- **Осмысленное размещение**: Новые задачи по умолчанию создаются вне доменов (независимые)
- **Выбор размещения**: Добавлена кнопка 🏠 для создания задач в активном домене
- **Умные подсказки**: Кнопка домена активна только при выбранном домене
- **Понятные уведомления**: Показывается где именно создана задача

### Улучшенный инспектор задач
- **Редактирование названия**: Можно изменить название задачи прямо в инспекторе
- **Кнопки статуса**: Визуальные кнопки для смены статуса с подсветкой активного
- **Приоритет**: Выпадающий список для выбора приоритета (1-4)
- **Время выполнения**: Поле для указания времени (30м, 1ч, 2ч 30м)
- **Теги**: Поле для добавления тегов через запятую
- **Кнопка "Сохранить"**: Применяет все изменения одной кнопкой

### Исправлено
- **Видимость задач**: Исправлена проблема с отображением созданных задач на карте
- **Логика размещения**: Убрана случайная привязка к первому домену в списке
- **Автовыбор домена**: Если нет активного домена, задачи создаются независимыми

---

## Atlas_of_life_v0.2.7.9 - 2025-09-09

### Улучшения быстрого ввода
- **Автодополнение тегов**: При вводе `#` показываются существующие теги с иконками
- **Автодополнение проектов**: При вводе `@` показываются существующие проекты
- **Автодополнение времени**: При вводе `!` показываются варианты времени (сегодня, завтра, дни недели)
- **Умная вставка**: Клик по предложению автоматически вставляет значение
- **Визуальные подсказки**: Иконки и описания для каждого типа автодополнения

### Исправлено
- **Поиск в панели**: Исправлена работа поиска с правильными вызовами функций
- **Очистка поиска**: Добавлена очистка `state.searchResults` при сбросе поиска
- **Безопасность**: Добавлены проверки для `window.layoutMap` и `window.drawMap`

---

## Atlas_of_life_v0.2.7.8 - 2025-09-09

### Исправлено
- **Критические ошибки**: Исправлены ошибки JavaScript, которые ломали работу приложения
- **Дублирование переменных**: Устранено дублирование переменной `stats` в коде
- **Неопределенные функции**: Добавлены проверки для `layoutMap` и `drawMap`
- **Безопасность поиска**: Добавлены проверки для `state.searchResults` перед обращением к свойствам
- **Стабильность**: Приложение теперь работает стабильно без зависаний

---

## Atlas_of_life_v0.2.7.7 - 2025-09-09

### Улучшения панели слева
- **Поиск**: Добавлен поиск по доменам, проектам и задачам с подсветкой результатов
- **Статистика**: Отображается количество задач по статусам в реальном времени
- **Фильтры по статусам**: Быстрые фильтры "Все", "План", "Сегодня", "В работе", "Готово"
- **Улучшенная информация**: Домены показывают количество проектов и задач
- **Подсветка поиска**: Найденные элементы подсвечиваются золотым цветом на карте
- **Клавиша Escape**: Очистка поиска по нажатию Escape

### Исправлено
- **Фильтрация**: Улучшена логика фильтрации задач по статусам и поиску
- **Производительность**: Оптимизирован рендеринг панели с большим количеством элементов

---

## Atlas_of_life_v0.2.7.6 - 2025-09-09

### Космические улучшения
- **Звёздное поле**: Добавлено анимированное звёздное поле с мерцающими звёздами
- **Планеты**: Заменены простые кружки на текстурированные планеты с градиентами
- **Туманности**: Домены теперь отображаются как цветные туманности с эффектами
- **Космические объекты**: Задачи стали звёздами/астероидами с разными формами по статусам
- **Параллакс**: Звёзды движутся с эффектом параллакса при навигации
- **Анимации**: Добавлены пульсирующие эффекты для задач "в работе"

### Исправлено
- **Фон карты**: Улучшен градиент фона для более глубокого космического вида
- **Производительность**: Оптимизирован рендеринг звёзд с проверкой видимости

---

## Atlas_of_life_v0.2.7.5 - 2025-09-09

### Улучшения интерфейса
- **Компактный header**: Уменьшены отступы и размеры кнопок для экономии места
- **Градиентный логотип**: Добавлен красивый градиент для названия приложения
- **Улучшенные статусы**: Статусы задач теперь с подсветкой и подсказками
- **Анимированное поле ввода**: Поле быстрого добавления с эффектами фокуса

### Исправлено
- **Версия приложения**: Исправлено отображение версии v0.2.7.5 в интерфейсе
- **Перенос текста**: Исправлен перенос текста в статусах (например, "в работе")
- **Кэширование**: Добавлены скрипты для принудительного обновления кэша

### Техническое
- Улучшена система обновления timestamp для обхода кэша браузера
- Оптимизированы CSS стили для более компактного отображения
- Исправлена логика отображения версии в модальном окне "О версии"

---

## Atlas_of_life_v0.2.7 - 2025-09-09

### Исправлено
- **DnD баги**: Независимые задачи теперь прикрепляются к домену при перетаскивании внутрь
- **Инспектор**: Исправлено отображение домена для всех задач
- **Привязка к проекту**: Добавлена корректная установка domainId при привязке задач к проектам
- **fitActiveProject()**: Полностью переписана сломанная функция подгонки вида к проекту
- **Обработка ошибок**: Улучшена обработка ошибок в операциях перетаскивания

### Техническое
- Консолидация логики confirmDetach() в единую реализацию
- Исправление CSS селекторов и классов toast
- Глобальное экспонирование функций для кросс-модульного доступа

---

## Atlas_of_life_v0.2.6 - 2025-09-06

### Добавлено
- Миграции хранилища (SCHEMA_VERSION + MIGRATIONS).
- Слой адаптеров хранилища (localStorageAdapter); заглушка IndexedDB.
- Локальный логгер аналитики (последние 100 событий в Local Storage).
- Inbox: автодополнение #/@.
- Today: бейдж срока и сортировка (срок → приоритет → updatedAt).
- Карта: двойной клик — fit проекта.

### Изменено
- Перерисовка карты сглажена (throttle); отсечение объектов вне области видимости.
- Тема через CSS‑переменные и переключатель (сохранение состояния).

### Исправлено
- Удалены «мертвые» ветви в раскладке карты.
- Убраны предупреждения о встроенных стилях (fileImport/viewToday/modal/toast/zoom slider).

## Atlas_of_life_v0.2.5 - 2025-09-04

Добавлено/изменено

- Новый алгоритм размещения задач внутри проектов: задачи группируются по кольцам, равномерно распределяются по окружности, что исключает пересечения.
- Динамический расчет радиусов проектов в зависимости от количества задач.
- Магнитное поведение при перетаскивании задачи внутрь проекта: задача примагничивается к краю круга.
- Возможность вытаскивать задачи из проекта с подтверждением пользователя.
- Исправлены синтаксические ошибки и дублирующиеся блоки кода, влияющие на отображение карты.

## Atlas_of_life_v0.2.4 - 2025-09-04 13:26

Добавлено/изменено

- Единая русская терминология в UI: легенда статусов в шапке — «план / сегодня / в работе / готово» (вместо backlog/today/doing/done).
- Переводы элементов в хедере: «Свечение» вместо Glow; «Подогнать домен/проект» вместо Fit.

## Atlas_of_life_v0.2.3 - 2025-09-04 13:20

Добавлено

- Сохранение пользовательских переключателей и вида: `Связи/Давность/Свечение` и активный `вид` (карта/сегодня) сохраняются в storage и восстанавливаются при запуске.
- Today/Inspector: отметка задач чекбоксом и «в Today» теперь сохраняются (добавлен saveState).

Изменено

- Удалены дубли CSS правил `.domenu`.
- Старые функции контекстного меню помечены как устаревшие (не используются), чтобы не мешать навигации в коде.

## Atlas_of_life_v0.2.2 - 2025-09-04 03:03

Добавлено

- Скрипт авто‑бампа версии: `tools/bump-version.ps1` — обновляет `CHANGELOG.md` и `js/app.js`.

Изменено

- Заголовок релиза содержит дату и время: `YYYY-MM-DD HH:mm`.
- Скрипт теперь вставляет НОВУЮ секцию релиза вверху, сохраняя историю (не перезаписывает предыдущую).

Добавлено

- CRUD доменов: создать, переименовать, изменить цвет (палитра), слить с…, удалить (перенос проектов / удаление вместе с задачами). Контекстное меню (⋯ / ПКМ).
- Fit/Focus: кнопки и хоткеи; двойной клик по домену — фокус.
- Кнопка «О версии»: модалка с номером версии и ссылкой на CHANGELOG; авто‑подхват версии из CHANGELOG.

Изменено

- Карта: зум к курсору, константная скорость панорамирования, единая матрица трансформации.
- Фильтры: домен/тег влияют на видимые узлы и рёбра.
- Размещение задач: «золотой угол», меньше наложений.
- Связи: адаптивная кривизна Безье (длинные — прямее).

Производительность

- Динамический cap рёбер + Glow с гистерезисом, FPS‑оверлей (Ctrl+Shift+F).

I18N/UX

- Очищены русские строки; улучшена читаемость ссылок в модалках.

Быстрый ввод

- RU‑парсер для #/@/~ p1..p4 и !сегодня/завтра/через N мин/ч, дни недели.

## Atlas_of_life_v0.2.1 - 2025-09-04 02:41

- Полировка доменов и навигации карты: мягкие подсказки при создании/переименовании, мгновенный пересчёт счётчиков, плавный Fit/Focus с ограничением масштаба, палитра цвета с немедленным применением, безопасное удаление/слияние доменов и тосты со сводкой переносов/удалений.

## Atlas_of_life_v0.1.0 — 2025‑08‑XX

Первый релиз (MVP)

- Карта, экран «Сегодня», экспорт/импорт JSON, демо‑данные.

## [Unreleased]

См. [IDEAS.md](./IDEAS.md) для планов и идей.

### Added
- Storage migrations and adapter layer.
- Light/dark theme via CSS variables and toggle.
- Local analytics (ring buffer in localStorage).
- Map: dbl-click project to fit bbox.
- Map: viewport culling of tasks/links.
- Inbox autocomplete (#/@), Today sorting + due badge, .ics export.

### Changed
- Throttled redraws on wheel/drag.
- Minor CSS variable refinements.

### Fixed
- Removed dead branches in map code.
- Reduced potential lag spikes on interactions.

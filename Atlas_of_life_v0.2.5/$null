function onMouseMove(e){
  if(viewState.dragging){
    const dx = (e.clientX - viewState.lastX), dy=(e.clientY - viewState.lastY);
    const dpr = window.devicePixelRatio||1;
    viewState.tx += (dx*dpr)/viewState.scale; viewState.ty += (dy*dpr)/viewState.scale;
    viewState.lastX = e.clientX; viewState.lastY = e.clientY;
    drawMap(); return;
  }
  const pt = screenToWorld(e.offsetX, e.offsetY);
  const n = hit(pt.x, pt.y);
  if(!n){ hoverNodeId=null; tooltip.style.opacity=0; drawMap(); return; }
  tooltip.style.left = e.clientX + 'px';
  tooltip.style.top  = e.clientY + 'px';
  tooltip.style.opacity = 1;
  hoverNodeId = n.id;
  if(n._type==='task'){
    const t = state.tasks.find(x=>x.id===n.id);
    tooltip.innerHTML = `🪐 <b>${t.title}</b>`;
  } else if(n._type==='project'){
    const p = state.projects.find(x=>x.id===n.id);
    tooltip.innerHTML = `🛰 <b>${p.title}</b>`;
  } else {
    const d = state.domains.find(x=>x.id===n.id);
    tooltip.innerHTML = `🌌 <b>${d.title}</b>`;
  }
  drawMap();
}

